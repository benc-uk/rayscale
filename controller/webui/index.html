<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--script src="https://unpkg.com/vue@2.5.16/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuejs-dialog@0.9.0/dist/vuejs-dialog.min.js"></script-->
  <script defer src="https://use.fontawesome.com/releases/v5.0.9/js/all.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Questrial" rel="stylesheet">

  <title>RayScale WebUI</title>

  <link rel="stylesheet" href="css/app.css">
  <link rel="icon" href="img/favicon.png">
</head>

<body>

  <h1>RayScale - Distributed Ray Tracer</h1>
  <h2><i class="fa fa-code"></i> Job Input</h2>

    <textarea id="jobInput">{
  "name": "testJob",
  "width": 800,
  "height": 600,
  "scene": {
    "name": "testScene",
    "backgroundColour": [20, 20, 60],
    "ambientLevel": 0.2,
    "cameraFov": 30,
    "lights": [{"pos": [5,5,-23]}],
    "objects": [
      {
        "type": "sphere",
        "name": "sphere1",
        "pos": [3,0.5,-20],
        "size": 1.8,
        "colour": [200, 100, 50]
      },
      {
        "type": "sphere",
        "name": "sphere2",
        "pos": [1,-0.8,-20],
        "size": 1.9,
        "colour": [20, 10, 250]
      }
    ]
  }
}</textarea><br/>
    <button onclick="jobSubmitter()">Start Job</button>
    <input type="text" id="resp" readonly style="width: 300px"/>
  <hr/>

  <h2><i class="fa fa-coffee"></i> Job Output</h2>
  <ul>
    <li><i class="fa fa-image"></i>  <a href="/jobs/testJob/render.png">testJob/render.png</a></li>
  </ul>

  <!--<div id="app">
  </div>
  <script src="js/app.js"></script>
  -->

  <script>
  function jobSubmitter() {
    let job = document.getElementById('jobInput').value;
    console.log(job);
    fetch("/api/job",
    {
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        method: "POST",
        body: job
    })
    .then(res => { 
      res.json().then(j => {document.getElementById('resp').value=JSON.stringify(j)});
     })
    .catch(err => {
      err.json().then(j => {document.getElementById('resp').value=("r"+JSON.stringify(j))});
    })
  }
  </script>
</body>

</html>
